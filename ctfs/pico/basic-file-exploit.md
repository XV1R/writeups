# basic file exploit
## Binary exploitation challenge from picoCTF2022

### Solution
Reading the source code, we can see that the *data_read()* function handles the user's input when trying to read data. The following looks interesting
```c
if ((entry_number = strtol(entry, NULL, 10)) == 0) {
    puts(flag);
    fseek(stdin, 0, SEEK_END);
    exit(0);
  }

```
Here we see the use of the stlib function _strtol_. This function takes the initial part of a given string and converts it to a **long int** value according to a given base. In our case, we can see it's taking our entry number, passing **NULL** as the end pointer and tries to convert the number to base 10 (regular decimal). If this entry number is 0, it will output the _flag_ variable. 
Therefore, we should try inputting **0** as a value to see what happens

```
Please put in a valid number
1
1
Please enter your data:
test-data
test-data
Please enter the length of your data:
10
10
Your entry number is: 1
Write successful, would you like to do anything else?
2
2
Please enter the entry number of your data:
0
0
picoCTF{M4K3_5UR3_70_CH3CK_Y0UR_1NPU75_00AAD6B3}

```
And the challenge is solved.